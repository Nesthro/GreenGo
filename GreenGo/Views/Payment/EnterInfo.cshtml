@model GreenGo.Models.PaymentViewModel
@{
    ViewBag.Title = "Enter Payment Info";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<style>
    body {
        background-color: #ffffff;
    }

    .reservation-container {
        max-width: 1000px;
        margin: 0 auto;
        padding: 40px 20px;
        display: flex;
        gap: 40px;
    }

    .main-section {
        flex: 1;
    }

    .sidebar-section {
        width: 320px;
        flex-shrink: 0;
    }

    /* Progress Indicator */
    .progress-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 50px;
        position: relative;
        max-width: 500px;
    }

    .progress-line {
        position: absolute;
        top: 15px;
        left: 30px;
        right: 30px;
        height: 2px;
        background-color: #E0E0E0;
        z-index: 0;
    }

    .progress-line-fill {
        height: 100%;
        width: 50%;
        background-color: #7CB342;
    }

    .progress-step {
        display: flex;
        flex-direction: column;
        align-items: center;
        position: relative;
        z-index: 1;
    }

    .progress-circle {
        width: 30px;
        height: 30px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 8px;
        font-size: 14px;
        font-weight: 600;
        background-color: #E0E0E0;
        color: #fff;
    }

    .progress-circle.completed {
        background-color: #7CB342;
    }

    .progress-circle.current {
        background-color: #9E9E9E;
    }

    .progress-label {
        font-size: 13px;
        color: #666;
        white-space: nowrap;
    }

    .progress-step.current .progress-label {
        font-weight: 600;
        color: #333;
    }

    /* Section Headers */
    .section-header {
        font-size: 20px;
        font-weight: 600;
        color: #333;
        margin-bottom: 20px;
    }

    .section-subheader {
        font-size: 16px;
        font-weight: 600;
        color: #333;
        margin-bottom: 15px;
    }

    /* Cards */
    .info-card {
        background-color: #FAFAFA;
        border: 1px solid #E0E0E0;
        border-radius: 8px;
        padding: 20px;
        margin-bottom: 20px;
    }

    /* Other Info Card */
    .booking-item {
        display: flex;
        gap: 15px;
        align-items: center;
    }

    .booking-image {
        width: 60px;
        height: 60px;
        background-color: #E0E0E0;
        border-radius: 6px;
        flex-shrink: 0;
    }

    .booking-details h4 {
        font-size: 15px;
        font-weight: 600;
        color: #333;
        margin: 0 0 4px 0;
    }

    .booking-details p {
        font-size: 13px;
        color: #666;
        margin: 0;
    }

    /* Contact Info */
    .contact-description {
        font-size: 13px;
        color: #666;
        margin-bottom: 15px;
        line-height: 1.5;
    }

    .add-btn {
        background: transparent;
        border: 1px dashed #999;
        color: #666;
        padding: 8px 16px;
        border-radius: 4px;
        font-size: 13px;
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        gap: 6px;
        margin-bottom: 20px;
        transition: all 0.2s;
    }

    .add-btn:hover {
        border-color: #7CB342;
        color: #7CB342;
    }

    /* Form Elements */
    .form-field {
        margin-bottom: 16px;
    }

    .form-field label {
        display: block;
        font-size: 13px;
        font-weight: 600;
        color: #333;
        margin-bottom: 6px;
    }

    .form-field input[type="text"],
    .form-field input[type="email"],
    .form-field input[type="tel"] {
        width: 100%;
        padding: 10px 12px;
        border: 1px solid #E0E0E0;
        border-radius: 4px;
        font-size: 14px;
        color: #333;
        background-color: #fff;
        transition: border-color 0.2s;
    }

    .form-field input::placeholder {
        color: #999;
    }

    .form-field input:focus {
        outline: none;
        border-color: #7CB342;
    }

    .phone-wrapper {
        display: flex;
        gap: 10px;
    }

    .phone-wrapper select {
        width: 80px;
        padding: 10px 8px;
        border: 1px solid #E0E0E0;
        border-radius: 4px;
        font-size: 14px;
        background-color: #fff;
        cursor: pointer;
    }

    .phone-wrapper input {
        flex: 1;
    }

    .save-btn {
        background-color: #E0E0E0;
        color: #666;
        border: none;
        padding: 10px 20px;
        border-radius: 4px;
        font-size: 14px;
        cursor: pointer;
        float: right;
        transition: background-color 0.2s;
    }

    .save-btn:hover {
        background-color: #D0D0D0;
    }

    .clearfix::after {
        content: "";
        display: table;
        clear: both;
    }

    /* Terms and Info Banner */
    .terms-note {
        font-size: 12px;
        color: #666;
        line-height: 1.6;
        margin: 30px 0 15px 0;
    }

    .terms-note a {
        color: #1976D2;
        text-decoration: none;
    }

    .terms-note a:hover {
        text-decoration: underline;
    }

    .info-alert {
        background-color: #FFF9E6;
        border: 1px solid #FFE082;
        border-radius: 6px;
        padding: 15px;
        font-size: 13px;
        color: #666;
        line-height: 1.6;
        margin-bottom: 30px;
    }

    /* Action Section */
    .action-section {
        background-color: #FAFAFA;
        border-top: 1px solid #E0E0E0;
        padding: 20px;
        margin: 30px -20px -20px -20px;
        text-align: right;
        border-radius: 0 0 8px 8px;
    }

    .action-section p {
        font-size: 13px;
        color: #666;
        margin-bottom: 15px;
    }

    .payment-btn {
        background-color: #7CB342;
        color: white;
        border: none;
        padding: 12px 30px;
        border-radius: 4px;
        font-size: 15px;
        font-weight: 600;
        cursor: pointer;
        transition: background-color 0.2s;
    }

    .payment-btn:hover {
        background-color: #689F38;
    }

    /* Sidebar */
    .summary-card {
        background-color: #FAFAFA;
        border: 1px solid #E0E0E0;
        border-radius: 8px;
        padding: 20px;
    }

    .summary-card h3 {
        font-size: 16px;
        font-weight: 600;
        color: #333;
        margin: 0 0 20px 0;
    }

    .summary-section {
        margin-bottom: 20px;
    }

    .summary-section h4 {
        font-size: 14px;
        font-weight: 600;
        color: #333;
        margin: 0 0 12px 0;
    }

    .summary-list {
        list-style: none;
        padding: 0;
        margin: 0;
    }

    .summary-list li {
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 13px;
        color: #666;
        margin-bottom: 8px;
        line-height: 1.4;
    }

    .summary-list li span:first-child {
        flex: 1;
    }

    .summary-list li span:last-child {
        font-weight: 600;
        color: #333;
    }

    .summary-divider {
        border: none;
        border-top: 1px solid #E0E0E0;
        margin: 20px 0;
    }

    .summary-total {
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 16px;
        font-weight: 600;
        color: #333;
    }

    .summary-total .amount {
        color: #7CB342;
        font-size: 18px;
    }

  

        .sidebar-section {
            width: 100%;
        }

        .progress-header {
            max-width: 100%;
        }
    }
</style>

<div class="reservation-container">
    <div class="main-section">
        <!-- Progress Header -->
        <div class="progress-header">
            <div class="progress-line">
                <div class="progress-line-fill"></div>
            </div>
            <div class="progress-step completed">
                <div class="progress-circle completed">✓</div>
                <span class="progress-label">Choose Booking</span>
            </div>
            <div class="progress-step current">
                <div class="progress-circle current"></div>
                <span class="progress-label">Enter Info</span>
            </div>
            <div class="progress-step">
                <div class="progress-circle"></div>
                <span class="progress-label">Pay</span>
            </div>
        </div>

        <h1 class="section-header">Enter Info</h1>

        <form action="@Url.Action("ProcessPayment", "Payment")" method="post">
            @Html.AntiForgeryToken()

            <input type="hidden" name="PlaceName" value="@Model.PlaceName" />
            <input type="hidden" name="TotalFee" value="@Model.TotalFee" />
            <input type="hidden" name="CartDataJson" value="@Model.CartDataJson" />

            <!-- Other Info Section -->
            <div>
                <h2 class="section-subheader">Other Info</h2>
                <div class="info-card">
                    <div class="booking-item">
                        <div class="booking-image"></div>
                        <div class="booking-details">
                            <h4>@Model.PlaceName</h4>
                            <p>Single Ticket</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Contact Info Section -->
            <div>
                <h2 class="section-subheader">Contact Info</h2>
                <div class="info-card">
                    <p class="contact-description">We'll contact you only if there's any updates to your booking.</p>

                    <button type="button" class="add-btn">
                        <span>+</span> Add
                    </button>

                    <div class="form-field">
                        <label for="name">Name</label>
                        <input type="text" id="name" name="Name" placeholder="First name" required />
                    </div>

                    <div class="form-field">
                        <input type="text" id="lastName" name="LastName" placeholder="Last name" required />
                    </div>

                    <div class="form-field">
                        <label for="email">Email</label>
                        <input type="email" id="email" name="Email" placeholder="Your email" required />
                    </div>

                    <div class="form-field">
                        <label for="phone">Phone</label>
                        <div class="phone-wrapper">
                            <select name="PhoneCountryCode">
                                <option value="+63">🇵🇭 +63</option>
                                <option value="+1">🇺🇸 +1</option>
                                <option value="+44">🇬🇧 +44</option>
                                <option value="+86">🇨🇳 +86</option>
                            </select>
                            <input type="tel" id="phone" name="PhoneNumber" placeholder="9XX XXX XXXX" required />
                        </div>
                    </div>

                    <div class="clearfix">
                        <button type="button" class="save-btn">Save</button>
                    </div>
                </div>
            </div>

            <!-- Terms -->
            <p class="terms-note">
                By continuing, you acknowledge and accept our <a href="#">General Terms of Use</a> and <a href="#">Privacy Policy</a>.
            </p>

            <!-- Info Banner -->
            <div class="info-alert">
                Once your info is submitted, it cannot be changed. Please double-check before proceeding.
                <br>Your booking will be submitted to the venue, and you can choose your payment method in the next step.
            </div>

            <!-- Action Section -->
            <div class="action-section">
                <p>Your booking will be submitted to the venue.</p>
                <button type="submit" class="payment-btn">Go to Payment</button>
            </div>
        </form>
    </div>

    <!-- Sidebar -->
    <div class="sidebar-section">
        <div class="summary-card">
            <h3>@Model.PlaceName</h3>

            <div class="summary-section">
                <h4>Single Ticket</h4>
                <ul class="summary-list" id="booking-summary-list">
                    <li>
                        <span>Planned participation date</span>
                        <span>05 Sep 2025</span>
                    </li>
                    <li>
                        <span>Quantity</span>
                        <span>University student x 1</span>
                    </li>
                </ul>
            </div>

            <hr class="summary-divider" />

            <div class="summary-total">
                <span>Total</span>
                <span class="amount">₱@Model.TotalFee.ToString("N2")</span>
            </div>
        </div>
    </div>
</div>

@section scripts {
    <script>
    $(document).ready(function() {
        // Parse cart data if available
        var cartData = '@Html.Raw(Model.CartDataJson)';
        if (cartData && cartData !== '') {
            try {
                var items = JSON.parse(cartData);
                var listHtml = '';
                items.forEach(function(item) {
                    listHtml += '<li><span>' + item.name + '</span><span>' + item.quantity + '</span></li>';
                });
                $('#booking-summary-list').html(listHtml);
            } catch (e) {
                console.error('Error parsing cart data:', e);
            }
        }

        // Save button functionality
        $('.save-btn').click(function() {
            // Validate form fields
            var isValid = true;
            $('.form-field input[required]').each(function() {
                if (!$(this).val()) {
                    isValid = false;
                    $(this).css('border-color', '#f44336');
                } else {
                    $(this).css('border-color', '#E0E0E0');
                }
            });

            if (isValid) {
                alert('Contact information saved!');
            } else {
                alert('Please fill in all required fields.');
            }
        });
    });
    </script>
}