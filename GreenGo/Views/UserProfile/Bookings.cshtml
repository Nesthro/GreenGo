@{
    ViewBag.Title = "Bookings - GreenGo";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<div class="main-container">
    <aside class="sidebar-fixed">
        @Html.Partial("_UserProfileSidebar")
    </aside>
    <main class="main-content bookings-main-content">
        <div class="bookings-page-container">
            <div class="bookings-header">
                <h1>Bookings</h1>
                <div class="header-controls">
                    <div class="search-box">
                        <i class="fa fa-search"></i>
                        <input type="text" placeholder="Search" id="searchInput">
                    </div>
                    <div class="sort-dropdown">
                        <label>Sort by :</label>
                        <select id="sortSelect">
                            <option value="newest">Newest</option>
                            <option value="oldest">Oldest</option>
                            <option value="name">Name</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="bookings-list" id="bookingsList"></div>
            <div class="pagination" id="pagination"></div>
        </div>
    </main>
</div>

<!-- Booking Details Modal -->
<div class="modal-overlay" id="bookingModal">
    <div class="modal-content">
        <div class="modal-header">
            <button class="modal-back-btn" onclick="closeModal()">
                <i class="fa fa-chevron-left"></i>
            </button>
            <h2>View Details</h2>
        </div>
        <div class="modal-body" id="modalBody"></div>
        <div class="modal-actions" id="modalActions"></div>
    </div>
</div>

<!-- Review Modal -->
<div class="modal-overlay" id="reviewModal">
    <div class="review-modal-content">
        <div class="review-modal-header">
            <button class="modal-back-btn" onclick="closeReviewModal()">
                <i class="fa fa-chevron-left"></i>
            </button>
            <h2>Review</h2>
        </div>
        <div class="review-modal-body">
            <div class="review-place-info">
                <div class="review-place-name" id="reviewPlaceName">National Museum of Fine Arts</div>
                <div class="review-place-address">
                    <i class="fa fa-map-marker-alt"></i>
                    <span id="reviewPlaceAddress">Ground Floor, National Museum of Fine Arts Building, P Padre Burgos Ave, Ermita, Manila, 1000 Metro Manila</span>
                </div>
            </div>
            <div class="review-section">
                <div class="review-section-title">How would you rate your experience?</div>
                <div class="star-rating" id="starRating">
                    <i class="fa fa-star" data-rating="1"></i>
                    <i class="fa fa-star" data-rating="2"></i>
                    <i class="fa fa-star" data-rating="3"></i>
                    <i class="fa fa-star" data-rating="4"></i>
                    <i class="fa fa-star" data-rating="5"></i>
                </div>
            </div>
            <div class="review-section">
                <div class="review-section-title">Share your thoughts</div>
                <div class="review-section-subtitle">Write at least 25 characters</div>
                <textarea class="review-textarea" id="reviewText" placeholder="Write a review and share your experience" maxlength="1000"></textarea>
                <div class="char-counter" id="charCounter">0/1000</div>
            </div>
            <div class="upload-photos-section">
                <div class="review-section-title">Upload Photos</div>
                <div class="upload-box" onclick="document.getElementById('photoUpload').click()">
                    <i class="fa fa-plus"></i>
                </div>
                <input type="file" id="photoUpload" accept="image/*" multiple style="display: none;">
            </div>
        </div>
        <div class="review-actions">
            <button class="modal-btn modal-btn-outline" onclick="closeReviewModal()">Cancel Review</button>
            <button class="modal-btn modal-btn-primary" onclick="submitReview()">Upload Review</button>
        </div>
    </div>
</div>

<!-- Cancellation Confirmation Modal -->
<div class="modal-overlay" id="cancelModal">
    <div class="cancel-modal-content">
        <div class="cancel-modal-body">
            <div class="cancel-icon">
                <i class="fa fa-exclamation-triangle"></i>
            </div>
            <h3 class="cancel-modal-title">Cancel Booking?</h3>
            <p class="cancel-modal-text">Are you sure you want to cancel this booking? This action cannot be undone.</p>
            <div class="cancel-modal-actions">
                <button class="cancel-btn cancel-btn-secondary" onclick="closeCancelModal()">No, Keep It</button>
                <button class="cancel-btn cancel-btn-danger" onclick="confirmCancellation()">Yes, Cancel</button>
            </div>
        </div>
    </div>
</div>

<!-- Receipt Modal -->
<div class="modal-overlay" id="receiptModal">
    <div class="receipt-modal-content">
        <div class="receipt-modal-header">
            <button class="modal-back-btn" onclick="closeReceiptModal()">
                <i class="fa fa-chevron-left"></i>
            </button>
            <h2>Receipt</h2>
            <div style="flex: 1;"></div>
            <button class="receipt-action-btn" onclick="printReceipt()" title="Print Receipt">
                <i class="fa fa-print"></i>
            </button>
            <button class="receipt-action-btn" onclick="downloadReceiptPDF()" title="Download Receipt">
                <i class="fa fa-download"></i>
            </button>
        </div>
        <div class="receipt-container">
            <div class="receipt-content" id="receiptContent">
                <div class="receipt-paper">
                    <div class="receipt-logo">GreenGo</div>
                    <div class="receipt-date" id="receiptDate">Mon, Oct 27, 2025 • 6:30:53 PM</div>

                    <div class="receipt-section">
                        <div class="receipt-id-box">
                            <div class="receipt-id-label">ID</div>
                            <div class="receipt-id-value" id="receiptIdValue">1234-567-8910</div>
                        </div>
                    </div>

                    <div class="receipt-section">
                        <div class="receipt-row">
                            <span class="receipt-label">Payment Type</span>
                            <span class="receipt-value" id="receiptPaymentType">Gcash</span>
                        </div>
                    </div>

                    <div class="receipt-divider"></div>

                    <div class="receipt-section">
                        <div class="receipt-row">
                            <span class="receipt-label">Customer Name</span>
                            <span class="receipt-value" id="receiptCustomerName">User</span>
                        </div>
                        <div class="receipt-row">
                            <span class="receipt-label">Address</span>
                            <span class="receipt-value" id="receiptAddress">National Museum, Manila</span>
                        </div>
                    </div>

                    <div class="receipt-divider"></div>

                    <div class="receipt-section">
                        <div class="receipt-row">
                            <span class="receipt-label">Amount</span>
                            <span class="receipt-value" id="receiptAmount">Free</span>
                        </div>
                        <div class="receipt-row receipt-total-row">
                            <span class="receipt-label">Total</span>
                            <span class="receipt-value" id="receiptTotal">Free</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    html, body {
        height: 100%;
        margin: 0;
        padding: 0;
    }

    body {
        min-height: 100vh;
        background: #fafafa;
    }

    .main-container {
        display: flex;
        min-height: 100vh;
        background: #fafafa;
        position: relative;
    }

    .sidebar-fixed {
        position: sticky;
        top: 0;
        height: 100vh;
        z-index: 10;
        background: #fafafa;
        flex-shrink: 0;
        overflow-y: auto;
    }

    .main-content.bookings-main-content {
        flex: 1;
        padding: 40px 60px;
        min-height: 100vh;
    }

    .bookings-page-container {
        width: 100%;
        max-width: 100%;
        background: transparent;
    }

    .bookings-header {
        margin-bottom: 32px;
    }

    .bookings-header h1 {
        font-size: 32px;
        font-weight: 700;
        color: #000;
        margin: 0 0 24px 0;
    }

    .header-controls {
        display: flex;
        gap: 16px;
        align-items: center;
        justify-content: flex-end;
    }

    .search-box {
        position: relative;
        width: 280px;
    }

    .search-box i {
        position: absolute;
        left: 26px;
        top: 50%;
        transform: translateY(-50%);
        color: #999;
        font-size: 14px;
    }

    .search-box input {
        width: 100%;
        padding: 10px 16px 10px 44px;
        border: 1px solid #e5e5e5;
        border-radius: 8px;
        font-size: 14px;
        outline: none;
        transition: border-color 0.3s;
        background: white;
    }

    .search-box input:focus {
        border-color: #8fb91c;
    }

    .sort-dropdown {
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .sort-dropdown label {
        font-size: 14px;
        color: #666;
    }

    .sort-dropdown select {
        padding: 10px 36px 10px 16px;
        border: 1px solid #e5e5e5;
        border-radius: 8px;
        font-size: 14px;
        color: #000;
        background: white;
        cursor: pointer;
        outline: none;
        appearance: none;
        background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23333' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
        background-repeat: no-repeat;
        background-position: right 12px center;
        min-width: 120px;
    }

    .bookings-list {
        display: flex;
        flex-direction: column;
        gap: 24px;
        margin-bottom: 40px;
    }

    .booking-card {
        display: flex;
        gap: 0;
        background: white;
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
        transition: box-shadow 0.3s;
        height: 240px;
    }

    .booking-card:hover {
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.12);
    }

    .booking-image {
        width: 200px;
        height: 240px;
        flex-shrink: 0;
    }

    .booking-image img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .booking-content {
        display: flex;
        flex: 1;
        padding: 32px 28px;
        gap: 24px;
    }

    .booking-details {
        flex: 1;
        display: flex;
        flex-direction: column;
    }

    .booking-location {
        font-size: 13px;
        color: #666;
        margin-bottom: 8px;
    }

    .booking-name {
        font-size: 18px;
        font-weight: 600;
        color: #000;
        margin-bottom: 12px;
    }

    .booking-rating {
        display: flex;
        align-items: center;
        gap: 6px;
        margin-bottom: 16px;
    }

    .rating-star {
        color: #ffc107;
        font-size: 16px;
    }

    .rating-value {
        font-size: 14px;
        font-weight: 600;
        color: #000;
    }

    .rating-count {
        font-size: 14px;
        color: #666;
    }

    .booking-description {
        font-size: 14px;
        color: #666;
        line-height: 1.6;
    }

    .booking-actions {
        display: flex;
        flex-direction: column;
        gap: 16px;
        align-items: flex-end;
        justify-content: space-between;
        min-width: 140px;
    }

    .status-badge {
        padding: 8px 20px;
        border-radius: 8px;
        font-size: 13px;
        font-weight: 500;
        border: 1px solid;
    }

    .status-done {
        background: #e8f5e9;
        color: #2e7d32;
        border-color: #a5d6a7;
    }

    .status-ongoing {
        background: #fff3e0;
        color: #e65100;
        border-color: #ffcc80;
    }

    .btn-view-details {
        padding: 10px 24px;
        background: white;
        color: #8fb91c;
        border: 1px solid #8fb91c;
        border-radius: 8px;
        font-size: 13px;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.3s;
    }

    .btn-view-details:hover {
        background: #8fb91c;
        color: white;
    }

    .pagination {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 6px;
        padding: 20px 0;
    }

    .pagination button {
        min-width: 32px;
        height: 32px;
        padding: 0 8px;
        border: none;
        background: transparent;
        color: #666;
        border-radius: 6px;
        font-size: 14px;
        cursor: pointer;
        transition: all 0.3s;
    }

    .pagination button:hover:not(:disabled):not(.active) {
        background: #f5f5f5;
    }

    .pagination button.active {
        background: #6366f1;
        color: white;
    }

    .pagination button:disabled {
        opacity: 0.3;
        cursor: not-allowed;
    }

    /* Modal Styles */
    .modal-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        backdrop-filter: blur(8px);
        z-index: 1000;
        justify-content: center;
        align-items: center;
        padding: 20px;
    }

    .modal-overlay.active {
        display: flex;
    }

    .modal-content {
        background: white;
        border-radius: 16px;
        max-width: 700px;
        width: 100%;
        max-height: 90vh;
        overflow-y: auto;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    }

    .modal-header {
        padding: 24px 32px;
        border-bottom: 1px solid #f0f0f0;
        display: flex;
        align-items: center;
        gap: 12px;
    }

    .modal-back-btn {
        background: none;
        border: none;
        cursor: pointer;
        padding: 8px;
        color: #333;
        font-size: 18px;
        transition: color 0.3s;
    }

    .modal-back-btn:hover {
        color: #8fb91c;
    }

    .modal-header h2 {
        font-size: 18px;
        font-weight: 600;
        color: #000;
        margin: 0;
    }

    .modal-body {
        padding: 32px;
    }

    .modal-section {
        margin-bottom: 24px;
    }

    .modal-section-title {
        font-size: 16px;
        font-weight: 600;
        color: #000;
        margin-bottom: 16px;
    }

    .modal-info-grid {
        background: #f8f8f8;
        border-radius: 12px;
        padding: 20px;
    }

    .modal-info-row {
        display: flex;
        justify-content: space-between;
        padding: 8px 0;
        font-size: 14px;
    }

    .modal-info-label {
        color: #666;
    }

    .modal-info-value {
        color: #000;
        font-weight: 500;
    }

    .modal-actions {
        display: flex;
        gap: 12px;
        padding: 24px 32px;
        border-top: 1px solid #f0f0f0;
    }

    .modal-btn {
        flex: 1;
        padding: 12px 24px;
        border-radius: 8px;
        font-size: 14px;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.3s;
        border: 1px solid;
    }

    .modal-btn-outline {
        background: white;
        color: #333;
        border-color: #e0e0e0;
    }

    .modal-btn-outline:hover {
        background: #f5f5f5;
        border-color: #8fb91c;
        color: #8fb91c;
    }

    .modal-btn-primary {
        background: #8fb91c;
        color: white;
        border-color: #8fb91c;
    }

    .modal-btn-primary:hover {
        background: #7da619;
    }

    /* Review Modal */
    .review-modal-content {
        background: white;
        border-radius: 16px;
        max-width: 600px;
        width: 100%;
        max-height: 90vh;
        overflow-y: auto;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    }

    .review-modal-header {
        padding: 20px 24px;
        border-bottom: 1px solid #f0f0f0;
        display: flex;
        align-items: center;
        gap: 12px;
    }

    .review-modal-header h2 {
        font-size: 18px;
        font-weight: 600;
        margin: 0;
    }

    .review-modal-body {
        padding: 24px;
    }

    .review-place-info {
        background: #f8f8f8;
        padding: 16px;
        border-radius: 12px;
        margin-bottom: 24px;
    }

    .review-place-name {
        font-size: 15px;
        font-weight: 600;
        margin-bottom: 8px;
    }

    .review-place-address {
        display: flex;
        gap: 8px;
        font-size: 13px;
        color: #666;
    }

    .review-section {
        margin-bottom: 24px;
    }

    .review-section-title {
        font-size: 15px;
        font-weight: 600;
        margin-bottom: 12px;
    }

    .review-section-subtitle {
        font-size: 12px;
        color: #999;
        margin-bottom: 12px;
    }

    .star-rating {
        display: flex;
        gap: 8px;
    }

    .star-rating i {
        font-size: 32px;
        color: #e0e0e0;
        cursor: pointer;
        transition: color 0.2s;
    }

    .star-rating i.active,
    .star-rating i:hover {
        color: #ffc107;
    }

    .review-textarea {
        width: 100%;
        min-height: 120px;
        padding: 16px;
        border: 1px solid #e0e0e0;
        border-radius: 12px;
        font-size: 14px;
        font-family: inherit;
        resize: vertical;
        outline: none;
    }

    .review-textarea:focus {
        border-color: #8fb91c;
    }

    .char-counter {
        text-align: right;
        font-size: 12px;
        color: #999;
        margin-top: 8px;
    }

    .upload-photos-section {
        margin-bottom: 24px;
    }

    .upload-box {
        width: 80px;
        height: 80px;
        background: #f5f5f5;
        border: 2px dashed #d0d0d0;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.3s;
    }

    .upload-box:hover {
        background: #efefef;
        border-color: #8fb91c;
    }

    .upload-box i {
        font-size: 28px;
        color: #666;
    }

    .review-actions {
        display: flex;
        gap: 12px;
        padding: 20px 24px;
        border-top: 1px solid #f0f0f0;
    }

    /* Cancel Modal */
    .cancel-modal-content {
        background: white;
        border-radius: 16px;
        max-width: 500px;
        width: 100%;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    }

    .cancel-modal-body {
        padding: 32px;
        text-align: center;
    }

    .cancel-icon {
        width: 64px;
        height: 64px;
        background: #fff3e0;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 20px;
    }

    .cancel-icon i {
        font-size: 32px;
        color: #ff9800;
    }

    .cancel-modal-title {
        font-size: 20px;
        font-weight: 600;
        margin-bottom: 12px;
    }

    .cancel-modal-text {
        font-size: 14px;
        color: #666;
        line-height: 1.6;
        margin-bottom: 24px;
    }

    .cancel-modal-actions {
        display: flex;
        gap: 12px;
    }

    .cancel-btn {
        flex: 1;
        padding: 12px 24px;
        border-radius: 8px;
        font-size: 14px;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.3s;
        border: 1px solid;
    }

    .cancel-btn-secondary {
        background: white;
        color: #333;
        border-color: #e0e0e0;
    }

    .cancel-btn-secondary:hover {
        background: #f5f5f5;
    }

    .cancel-btn-danger {
        background: #f44336;
        color: white;
        border-color: #f44336;
    }

    .cancel-btn-danger:hover {
        background: #d32f2f;
    }

    /* Receipt Modal */
    .receipt-modal-content {
        background: #2c2c2c;
        border-radius: 16px;
        max-width: 500px;
        width: 100%;
        max-height: 90vh;
        overflow: hidden;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        display: flex;
        flex-direction: column;
    }

    .receipt-modal-header {
        padding: 20px 24px;
        background: #D3D3D3;
        display: flex;
        align-items: center;
        gap: 12px;
        flex-shrink: 0;
    }

    .receipt-modal-header .modal-back-btn {
        color: #fff;
    }

    .receipt-modal-header .modal-back-btn:hover {
        color: #8fb91c;
    }

    .receipt-modal-header h2 {
        font-size: 18px;
        font-weight: 600;
        color: #fff;
        margin: 0;
    }

    .receipt-action-btn {
        background: transparent;
        border: 1px solid #444;
        color: #fff;
        width: 36px;
        height: 36px;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.3s;
        font-size: 14px;
    }

    .receipt-action-btn:hover {
        background: #444;
        border-color: #8fb91c;
        color: #8fb91c;
    }

    .receipt-container {
        flex: 1;
        overflow-y: auto;
        padding: 24px;
        background: white;
    }

    .receipt-content {
        display: flex;
        justify-content: center;
    }

    .receipt-paper {
        background: white;
        width: 100%;
        max-width: 384px;
        padding: 40px 32px;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    .receipt-logo {
        text-align: center;
        font-size: 32px;
        font-weight: 700;
        color: #8fb91c;
        margin-bottom: 16px;
        letter-spacing: -0.5px;
    }

    .receipt-date {
        text-align: center;
        font-size: 13px;
        color: #666;
        margin-bottom: 32px;
    }

    .receipt-section {
        margin-bottom: 24px;
    }

    .receipt-id-box {
        border: 2px dashed #ccc;
        border-radius: 12px;
        padding: 20px;
        text-align: center;
    }

    .receipt-id-label {
        font-size: 12px;
        color: #999;
        margin-bottom: 8px;
        letter-spacing: 3px;
    }

    .receipt-id-value {
        font-size: 18px;
        font-weight: 600;
        color: #000;
        letter-spacing: 1px;
        font-family: 'Courier New', monospace;
    }

    .receipt-row {
        display: flex;
        justify-content: space-between;
        margin-bottom: 12px;
        font-size: 14px;
    }

    .receipt-row:last-child {
        margin-bottom: 0;
    }

    .receipt-label {
        color: #666;
    }

    .receipt-value {
        color: #000;
        font-weight: 500;
        text-align: right;
        max-width: 60%;
    }

    .receipt-divider {
        height: 1px;
        background: repeating-linear-gradient(
            90deg,
            #ccc 0,
            #ccc 8px,
            transparent 8px,
            transparent 16px
        );
        margin: 24px 0;
    }

    .receipt-total-row {
        margin-top: 12px;
        padding-top: 12px;
        border-top: 2px solid #e0e0e0;
        font-weight: 600;
        font-size: 15px;
    }

    .receipt-total-row .receipt-label,
    .receipt-total-row .receipt-value {
        color: #000;
        font-weight: 600;
    }

    @@media print {
        body * {
            visibility: hidden;
        }

        #receiptContent,
        #receiptContent * {
            visibility: visible;
        }

        #receiptContent {
            position: absolute;
            left: 50%;
            top: 0;
            transform: translateX(-50%);
        }

        .receipt-paper {
            box-shadow: none;
            max-width: 100%;
        }
    }

    @@media (max-width: 1024px) {
        .booking-card {
            height: auto;
            flex-direction: column;
        }

        .booking-image {
            width: 100%;
            height: 200px;
        }

        .booking-content {
            flex-direction: column;
        }

        .booking-actions {
            flex-direction: row;
            align-items: center;
        }
    }
</style>

<script>
    const bookingsData = [
        {
            id: 1,
            name: 'National Museum of Fine Arts',
            location: 'Metro, Manila',
            rating: 4.8,
            reviews: 269,
            description: 'The National Museum of Fine Arts is home to 29 galleries and hallway exhibitions',
            status: 'done',
            image: '/Content/images/national-museum-portrait.jpg',
            bookingId: '12345',
            dateBooked: 'October 12, 2025',
            visitDate: 'October 13, 2025',
            time: '10:00 AM - 12:00 PM',
            guests: '2 Adults'
        },
        {
            id: 2,
            name: 'Rizal Park',
            location: 'Metro, Manila',
            rating: 4.6,
            reviews: 532,
            description: 'A historical urban park located along Roxas Boulevard, Manila',
            status: 'ongoing',
            image: '/Content/images/rizal-park.jpg',
            bookingId: '12346',
            dateBooked: 'October 15, 2025',
            visitDate: 'October 20, 2025',
            time: '2:00 PM - 5:00 PM',
            guests: '4 Adults'
        },
        {
            id: 3,
            name: 'Intramuros',
            location: 'Metro, Manila',
            rating: 4.7,
            reviews: 445,
            description: 'The historic walled area within the city of Manila',
            status: 'done',
            image: '/Content/images/intramuros.jpg',
            bookingId: '12347',
            dateBooked: 'September 28, 2025',
            visitDate: 'October 5, 2025',
            time: '9:00 AM - 12:00 PM',
            guests: '3 Adults'
        },
        {
            id: 4,
            name: 'Manila Ocean Park',
            location: 'Metro, Manila',
            rating: 4.5,
            reviews: 678,
            description: 'An oceanarium in Manila that features marine and aquatic animals',
            status: 'ongoing',
            image: '/Content/images/ocean-park.jpg',
            bookingId: '12348',
            dateBooked: 'October 18, 2025',
            visitDate: 'October 25, 2025',
            time: '11:00 AM - 3:00 PM',
            guests: '2 Adults, 2 Children'
        },
        {
            id: 5,
            name: 'Fort Santiago',
            location: 'Metro, Manila',
            rating: 4.6,
            reviews: 389,
            description: 'A citadel built by Spanish navigator Miguel López de Legazpi',
            status: 'done',
            image: '/Content/images/fort-santiago.jpg',
            bookingId: '12349',
            dateBooked: 'September 20, 2025',
            visitDate: 'September 25, 2025',
            time: '8:00 AM - 11:00 AM',
            guests: '2 Adults'
        }
    ];

    let currentPage = 1;
    const itemsPerPage = 2;
    let filteredData = [...bookingsData];
    let currentBookingId = null;
    let selectedRating = 0;

    function renderBookings() {
        const startIndex = (currentPage - 1) * itemsPerPage;
        const endIndex = startIndex + itemsPerPage;
        const pageData = filteredData.slice(startIndex, endIndex);

        const bookingsList = document.getElementById('bookingsList');
        bookingsList.innerHTML = pageData.map(booking => `
            <div class="booking-card">
                <div class="booking-image">
                    <img src="${booking.image}" alt="${booking.name}" onerror="this.src='https://via.placeholder.com/200x240?text=Image'">
                </div>
                <div class="booking-content">
                    <div class="booking-details">
                        <div class="booking-location">${booking.location}</div>
                        <div class="booking-name">${booking.name}</div>
                        <div class="booking-rating">
                            <span class="rating-star">★</span>
                            <span class="rating-value">${booking.rating}</span>
                            <span class="rating-count">(${booking.reviews})</span>
                        </div>
                        <div class="booking-description">${booking.description}</div>
                    </div>
                    <div class="booking-actions">
                        <span class="status-badge status-${booking.status}">
                            ${booking.status.charAt(0).toUpperCase() + booking.status.slice(1)}
                        </span>
                        <button class="btn-view-details" onclick="viewDetails(${booking.id})">View Details</button>
                    </div>
                </div>
            </div>
        `).join('');

        renderPagination();
    }

    function renderPagination() {
        const totalPages = Math.ceil(filteredData.length / itemsPerPage);
        const pagination = document.getElementById('pagination');

        let paginationHTML = '';

        paginationHTML += `<button onclick="changePage(${currentPage - 1})" ${currentPage === 1 ? 'disabled' : ''}>
            <i class="fa fa-chevron-left"></i>
        </button>`;

        if (totalPages <= 7) {
            for (let i = 1; i <= totalPages; i++) {
                paginationHTML += `<button class="${i === currentPage ? 'active' : ''}" onclick="changePage(${i})">${i}</button>`;
            }
        } else {
            paginationHTML += `<button class="${1 === currentPage ? 'active' : ''}" onclick="changePage(1)">1</button>`;

            if (currentPage > 3) {
                paginationHTML += `<span class="ellipsis">...</span>`;
            }

            for (let i = Math.max(2, currentPage - 1); i <= Math.min(totalPages - 1, currentPage + 1); i++) {
                paginationHTML += `<button class="${i === currentPage ? 'active' : ''}" onclick="changePage(${i})">${i}</button>`;
            }

            if (currentPage < totalPages - 2) {
                paginationHTML += `<span class="ellipsis">...</span>`;
            }

            paginationHTML += `<button class="${totalPages === currentPage ? 'active' : ''}" onclick="changePage(${totalPages})">${totalPages}</button>`;
        }

        paginationHTML += `<button onclick="changePage(${currentPage + 1})" ${currentPage === totalPages ? 'disabled' : ''}>
            <i class="fa fa-chevron-right"></i>
        </button>`;

        pagination.innerHTML = paginationHTML;
    }

    function changePage(page) {
        const totalPages = Math.ceil(filteredData.length / itemsPerPage);
        if (page < 1 || page > totalPages) return;
        currentPage = page;
        renderBookings();
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function viewDetails(id) {
        const booking = bookingsData.find(b => b.id === id);
        if (!booking) return;

        currentBookingId = id;
        const modalBody = document.getElementById('modalBody');
        const modalActions = document.getElementById('modalActions');
        const stars = '★'.repeat(5);

        modalBody.innerHTML = `
            <div class="modal-section">
                <div style="display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 12px;">
                    <h3 class="modal-section-title" style="margin: 0;">${booking.name}</h3>
                    <span class="status-badge status-${booking.status}">
                        ${booking.status.charAt(0).toUpperCase() + booking.status.slice(1)}
                    </span>
                </div>
                <div style="display: flex; gap: 8px; color: #666; font-size: 14px; margin-bottom: 12px;">
                    <i class="fa fa-map-marker-alt" style="color: #8fb91c; margin-top: 3px;"></i>
                    <span>${booking.location}</span>
                </div>
                <div style="display: flex; align-items: center; gap: 6px;">
                    <span style="color: #ffc107; font-size: 16px;">★</span>
                    <span style="font-weight: 600; font-size: 14px;">${booking.rating}</span>
                    <span style="color: #666; font-size: 14px;">(${booking.reviews})</span>
                </div>
            </div>

            <div class="modal-section">
                <h3 class="modal-section-title">Booking Information</h3>
                <div class="modal-info-grid">
                    <div class="modal-info-row">
                        <span class="modal-info-label">Booking ID:</span>
                        <span class="modal-info-value">${booking.bookingId}</span>
                    </div>
                    <div class="modal-info-row">
                        <span class="modal-info-label">Date Booked:</span>
                        <span class="modal-info-value">${booking.dateBooked}</span>
                    </div>
                    <div class="modal-info-row">
                        <span class="modal-info-label">Visit Date:</span>
                        <span class="modal-info-value">${booking.visitDate}</span>
                    </div>
                    <div class="modal-info-row">
                        <span class="modal-info-label">Time:</span>
                        <span class="modal-info-value">${booking.time}</span>
                    </div>
                    <div class="modal-info-row">
                        <span class="modal-info-label">Guest:</span>
                        <span class="modal-info-value">${booking.guests}</span>
                    </div>
                </div>
            </div>

            <div class="modal-section">
                <h3 class="modal-section-title">About the place</h3>
                <div style="background: #f8f8f8; padding: 20px; border-radius: 12px; font-size: 14px; color: #666; line-height: 1.8;">
                    ${booking.description}. A wonderful destination for tourists and locals alike.
                </div>
            </div>

            <div class="modal-section" style="margin-bottom: 0;">
                <h3 class="modal-section-title">Payment Summary</h3>
                <div class="modal-info-grid">
                    <div class="modal-info-row">
                        <span class="modal-info-label">Entrance Fee:</span>
                        <span class="modal-info-value">₱ 0.00 (Free Entrance)</span>
                    </div>
                    <div class="modal-info-row">
                        <span class="modal-info-label">Booking Fee:</span>
                        <span class="modal-info-value">₱ 0.00</span>
                    </div>
                    <div class="modal-info-row" style="margin-top: 12px; padding-top: 12px; border-top: 2px solid #e0e0e0; font-weight: 600;">
                        <span class="modal-info-label">Total:</span>
                        <span class="modal-info-value">₱ 0.00</span>
                    </div>
                </div>
            </div>
        `;

        if (booking.status === 'done') {
            modalActions.innerHTML = `
                <button class="modal-btn modal-btn-outline" onclick="downloadReceipt()">Download Receipt</button>
                <button class="modal-btn modal-btn-outline" onclick="rebookVisit()">Rebook Visit</button>
                <button class="modal-btn modal-btn-primary" onclick="openReviewModal()">Leave a review</button>
            `;
        } else if (booking.status === 'ongoing') {
            modalActions.innerHTML = `
                <button class="modal-btn modal-btn-outline" onclick="downloadReceipt()">Download Receipt</button>
                <button class="modal-btn modal-btn-outline" onclick="rebookVisit()">Rebook Visit</button>
                <button class="modal-btn modal-btn-outline" style="background: #f44336; border-color: #f44336; color: white;" onclick="openCancelModal()">Cancel Booking</button>
            `;
        }

        document.getElementById('bookingModal').classList.add('active');
        document.body.style.overflow = 'hidden';
    }

    function closeModal() {
        document.getElementById('bookingModal').classList.remove('active');
        document.body.style.overflow = '';
    }

    function downloadReceipt() {
        const booking = bookingsData.find(b => b.id === currentBookingId);
        if (!booking) return;

        const now = new Date();
        const dateStr = now.toLocaleDateString('en-US', {
            weekday: 'short',
            year: 'numeric',
            month: 'short',
            day: 'numeric'
        });
        const timeStr = now.toLocaleTimeString('en-US', {
            hour: '2-digit',
            minute: '2-digit',
            second: '2-digit'
        });

        document.getElementById('receiptDate').textContent = `${dateStr} • ${timeStr}`;
        document.getElementById('receiptIdValue').textContent = `${booking.bookingId}-${booking.id}`;
        document.getElementById('receiptPaymentType').textContent = 'Gcash';
        document.getElementById('receiptCustomerName').textContent = 'User';
        document.getElementById('receiptAddress').textContent = `${booking.name}, ${booking.location}`;
        document.getElementById('receiptAmount').textContent = 'Free';
        document.getElementById('receiptTotal').textContent = 'Free';

        closeModal();
        document.getElementById('receiptModal').classList.add('active');
        document.body.style.overflow = 'hidden';
    }

    function closeReceiptModal() {
        document.getElementById('receiptModal').classList.remove('active');
        document.body.style.overflow = '';
    }

    function printReceipt() {
        window.print();
    }

    function downloadReceiptPDF() {
        const booking = bookingsData.find(b => b.id === currentBookingId);
        if (!booking) return;

        const receiptText = `
=====================================
           GreenGo Receipt
=====================================

Date: ${document.getElementById('receiptDate').textContent}

ID: ${document.getElementById('receiptIdValue').textContent}

-------------------------------------
Payment Type: ${document.getElementById('receiptPaymentType').textContent}
-------------------------------------

Customer Name: ${document.getElementById('receiptCustomerName').textContent}
Address: ${document.getElementById('receiptAddress').textContent}

-------------------------------------
Amount: ${document.getElementById('receiptAmount').textContent}
Total: ${document.getElementById('receiptTotal').textContent}

=====================================
      Thank you for your booking!
=====================================
        `;

        const blob = new Blob([receiptText], { type: 'text/plain' });
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `GreenGo-Receipt-${booking.bookingId}.txt`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        window.URL.revokeObjectURL(url);
    }

    function rebookVisit() {
        alert('Rebooking functionality will redirect to booking page');
    }

    function openReviewModal() {
        const booking = bookingsData.find(b => b.id === currentBookingId);
        if (booking) {
            document.getElementById('reviewPlaceName').textContent = booking.name;
            document.getElementById('reviewPlaceAddress').textContent = `${booking.location}`;
        }

        closeModal();
        document.getElementById('reviewModal').classList.add('active');
        document.body.style.overflow = 'hidden';
    }

    function closeReviewModal() {
        document.getElementById('reviewModal').classList.remove('active');
        document.body.style.overflow = '';
        selectedRating = 0;
        updateStarRating(0);
        document.getElementById('reviewText').value = '';
        document.getElementById('charCounter').textContent = '0/1000';
    }

    function updateStarRating(rating) {
        const stars = document.querySelectorAll('#starRating i');
        stars.forEach((star, index) => {
            if (index < rating) {
                star.classList.add('active');
            } else {
                star.classList.remove('active');
            }
        });
    }

    function submitReview() {
        const reviewText = document.getElementById('reviewText').value;

        if (selectedRating === 0) {
            alert('Please select a rating');
            return;
        }

        if (reviewText.length < 25) {
            alert('Please write at least 25 characters');
            return;
        }

        alert('Review submitted successfully!');
        closeReviewModal();
    }

    function openCancelModal() {
        closeModal();
        document.getElementById('cancelModal').classList.add('active');
        document.body.style.overflow = 'hidden';
    }

    function closeCancelModal() {
        document.getElementById('cancelModal').classList.remove('active');
        document.body.style.overflow = '';
    }

    function confirmCancellation() {
        alert('Booking has been cancelled successfully');
        closeCancelModal();

        const booking = bookingsData.find(b => b.id === currentBookingId);
        if (booking) {
            booking.status = 'cancelled';
        }
        renderBookings();
    }

    document.addEventListener('click', function (e) {
        const bookingModal = document.getElementById('bookingModal');
        const reviewModal = document.getElementById('reviewModal');
        const cancelModal = document.getElementById('cancelModal');
        const receiptModal = document.getElementById('receiptModal');

        if (e.target === bookingModal) closeModal();
        if (e.target === reviewModal) closeReviewModal();
        if (e.target === cancelModal) closeCancelModal();
        if (e.target === receiptModal) closeReceiptModal();
    });

    document.addEventListener('keydown', function (e) {
        if (e.key === 'Escape') {
            closeModal();
            closeReviewModal();
            closeCancelModal();
            closeReceiptModal();
        }
    });

    document.addEventListener('DOMContentLoaded', function () {
        const searchInput = document.getElementById('searchInput');
        searchInput.addEventListener('input', function (e) {
            const searchTerm = e.target.value.toLowerCase();
            filteredData = bookingsData.filter(booking =>
                booking.name.toLowerCase().includes(searchTerm) ||
                booking.location.toLowerCase().includes(searchTerm) ||
                booking.description.toLowerCase().includes(searchTerm)
            );
            currentPage = 1;
            renderBookings();
        });

        const sortSelect = document.getElementById('sortSelect');
        sortSelect.addEventListener('change', function (e) {
            const sortBy = e.target.value;
            if (sortBy === 'newest') {
                filteredData.sort((a, b) => b.id - a.id);
            } else if (sortBy === 'oldest') {
                filteredData.sort((a, b) => a.id - b.id);
            } else if (sortBy === 'name') {
                filteredData.sort((a, b) => a.name.localeCompare(b.name));
            }
            currentPage = 1;
            renderBookings();
        });

        const starRating = document.getElementById('starRating');
        if (starRating) {
            starRating.addEventListener('click', function (e) {
                if (e.target.tagName === 'I') {
                    selectedRating = parseInt(e.target.getAttribute('data-rating'));
                    updateStarRating(selectedRating);
                }
            });

            starRating.addEventListener('mouseover', function (e) {
                if (e.target.tagName === 'I') {
                    const rating = parseInt(e.target.getAttribute('data-rating'));
                    updateStarRating(rating);
                }
            });

            starRating.addEventListener('mouseout', function () {
                updateStarRating(selectedRating);
            });
        }

        const reviewText = document.getElementById('reviewText');
        if (reviewText) {
            reviewText.addEventListener('input', function () {
                const count = this.value.length;
                document.getElementById('charCounter').textContent = `${count}/1000`;
            });
        }

        renderBookings();
    });
</script>